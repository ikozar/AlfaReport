<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"-->
<html>
<head>
<title>ReportBuilder</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">

<style>
body {
background-color: #1C2C1C;
padding: 0px;
margin: 20px;
}
th {
border: 1px solid black;
}
td {
background-color: Khaki;
padding: 1px 3px;
}
td.m {
background-color: #4C4C4C;
border: 1px outset buttontext;
}
.arep {
background-image: url(image/arep.gif);
background-repeat: none;
margin: 5px;
height: 70px;
border: 2px inset black;
}

ul {
margin: 0px;
padding: 0px;
}
li.m {
display: block;
list-style-type: none;
padding: 5px;
height: 20px;
font-family: Georgia;
font-size: 15px;
font-weight: 900px;
color: black;
}
li.l {
float: left;
border-right: 2px solid black;
background-color: LightSkyBlue;
}
li.h {
margin-bottom: 5px;
border: 2px outset black;
background-color: GoldenRod;
color: black;
}

a.local {
text-decoration: none;
color: inherit;
}
span a.hl {
color: Crimson;
}

dt {
font-weight: 600;
display: compact;
height: 0px;
}
dd {
margin-left: 10em;
}
h1 {
font-size: 18px;
}
h2 {
font-size: 15px;
margin: 6px;
}
p {
x-text-indent: 10px;
}
</style>

<body>
<!-- report reporting builder отчет построение отчета -->

<table id="tabInf" width="100%" cellpadding=0 style="height: 98%;">
<tr>
	<td class="m" colspan="3" rowspan="2" style="border: 7px solid #1C2C1C; background-color: Peru;">
		<div class="arep" x-style="background-color: DarkGray; border: 2px inset LightSkyBlue;
			font-family: cursive; font-size: 31px; font-weight: 900;
			padding-left: 20px; text-align: left; color: black; ">
				<!--Report<BR/>&nbsp;&nbsp;Builder-->
		</div>
	</td>
	<td class="m" colspan="1" height="80px" width="80%" style="padding-left: 20px; color: Gold;">
		<span style="font-family: Verdana; font-size: 24px; font-weight: 900;">ReportBuilder. Демонстрация работы</span>
	</td>
	<td id="reclama" class="m" style="padding: 0px; border-left: 2px solid #4C4C4C;">
<div style="width:468px; height:60px"></div>	</td>
</tr>
<tr height="20px">
	<td class="m" colspan="3" rowspan="2" style="padding: 0px; background-color: LightSkyBlue;">
		<ul style="color: black;">
		<li class="m l"><a class="local" href="javascript:goTo('index');">Главная</a></li><li class="m l"><a class="local" href="javascript:goTo('cp');">Описание&nbsp;примера</a></li><li class="m l"><a class="local" href="javascript:goTo('demo');">Демонстрация</a></li><li class="m l"><a class="local" href="javascript:goTo('donate');">Спонсорство</a></li><li class="m l"><a class="local" href="../forum">Форум</a></li><li class="m l"><a class="local" href="javascript:goTo('index#refDN');">Загрузка</a></li>		</ul>
	</td>
</tr>
<tr>
	<td class="m" height="10px" style="background-color: transparent; border: 0px; 
		background-image: url(image/expand.gif);
		background-repeat: repeat-x; style: padding: 0px;
		">
	</td>
</tr>
<tr>
	<td class="m" width="190px" style="vertical-align: top; padding: 4px;">
		<ul style="color: black; padding: 3px;">
		<li class="m h"><a class="local" href="javascript:goTo('index');">Главная</a></li><li class="m h"><a class="local" href="javascript:goTo('ability');">Возможности</a></li><li class="m h"><a class="local" href="javascript:goTo('news');">Сопровождение</a></li><li class="m h"><a class="local" href="javascript:goTo('cp');">Описание&nbsp;примера</a></li><li class="m h"><a class="local" href="javascript:goTo('demo');">Демонстрация</a></li><li class="m h"><a class="local" href="javascript:goTo('donate');">Спонсорство</a></li><li class="m h"><a class="local" href="../forum">Форум</a></li><li class="m h" style="margin-top: 20px;"><a class="local" 
	href="m&#97;i&#108;t&#111;&#58;k&#111;z&#97;r_x&#64;m&#97;i&#108;&#46;ru?subject=ReportBuilder">Написать письмо</a></li>		</ul>
<div style="margin-top:30px; align: center;">
<!--LiveInternet counter--><script type="text/javascript"><!--
document.write("<a href='http://www.liveinternet.ru/click' "+
"target=_blank><img src='http://counter.yadro.ru/hit?t20.10;r"+
escape(document.referrer)+((typeof(screen)=="undefined")?"":
";s"+screen.width+"*"+screen.height+"*"+(screen.colorDepth?
screen.colorDepth:screen.pixelDepth))+";u"+escape(document.URL)+
";"+Math.random()+
"' alt='' title='LiveInternet: показано число просмотров за 24"+
" часа, посетителей за 24 часа и за сегодня' "+
"border=0 width=88 height=31><\/a>")//--></script><!--/LiveInternet-->
<!--div style="width:88px; height:31px; background-color:white;"/-->
</div>
	</td>
	<td class="m" width="6px;" colspan="2" style="background-color: transparent; border: 0px; 
		background-image: url(image/ns-expand.gif);
		background-repeat: repeat-y;
		">
	</td>
	<td class="m" colspan="2" style="overflow: scroll; background-color: LightYellow; padding: 10px 20px; color: DarkBlue;
		font-family: Lucida; font-weight: 400;">
		
<p>Для демонстрации работы ReportBuilder реализовано несколько примеров на тему показателей продаж (см. "Описание контрольного примера").

По соответствующим кнопкам будут показаны готовые, заранее сформированные отчеты. 
Чтобы посмотреть формирование ДЕМО-отчетов, Вы можете скачать ReportBuilder и запустить их на своей машине (<a class="local" href="javascript:goTo('ReadMe.txt');" style="color: Crimson;">см. ReadMe.txt</a>).

</p>
<table cellspacing=3>
<tr>
<th>№</th>
<th>Пример</th>
<th>запуск отчета</th>
<th>просмотр шаблона</th>
</tr>
<tr>
	<td>1</td>
	<td>
		пример отчета по поставкам и продажам по сотрудникам, создание кросс-таблицы по кварталам и месяцам, иерархическая группа "местонахождение"
	</td>
	<td style="text-align: center;"><button onClick="goTo('sample1.html');">выполнить</button></td>
	<td style="text-align: center;"><button onClick="goTo('sample1.urp.xml');">выполнить</button></td>
</tr>
<tr>
	<td>2</td>
	<td>
		пример отчета по поставкам и продажам по видам товаров, создание кросс-таблицы по кварталам, 
		местоположению производителей и производителям (на местоположение ссылаются две выборки - производители и магазины (из MAIN)), 
		сортировка по убыванию <b>итоговых</b> (годовых) показателей продаж по видам товаров, вывод 3 самых успешных и 3 отстающих в каждом магазине.<BR/>
		Дополнительно запрашиваются две "множественные" (SET) выборки: 
		руководство магазинов (выводятся в ячейке магазина через &lt;BR&gt;) и
		итоги по группам товаров (кросс по кварталам), которые выводятся в секции "TOTAL", в цикле по строкам выборки &lt;SetBand&gt;
	</td>
	<td style="text-align: center;"><button onClick="goTo('sample2.html');">выполнить</button></td>
	<td style="text-align: center;"><button onClick="goTo('sample2.urp.xml');">выполнить</button></td>
</tr>
<tr>
	<td>3</td>
	<td>
		пример отчета по поставкам и продажам формируемого в JSON (желательно смотреть в FireFox или Opera старше 9.1, иначе таблицу будет формироваться не через innerHTML, а DOM-функциями, что существенно медленнее), интерактирное сворачивание/разворачивание строк и колонок
	</td>
	<td style="text-align: center;"><button onClick="goTo('sample3.html');">выполнить</button></td>
	<td style="text-align: center;"><button onClick="goTo('sample1.urp.xml');">выполнить</button></td>
</tr>


</table>

<h1>Для просмотра доп. информации используте параметры в URL:</h1>
<ul>
<li>"urp_time=1" - времени формирования документа;</li>
<li>"urp_print_data=1|перечень выборок" - всех данных/данных выборки;</li>
<li>"urp_print_band=1|перечень секций" - текста секций/секции</li>
<li>"urp_print_query=1" - текста запросов</li>
</ul>
<BR/>

Шаблон отчета задается в XML файле в любом тектовом или XML редакторе.
При желании можно сделать визуальный дизайнер, но я не вижу в этом большого смысла.
Структура файла несложная, но в то же время он позволяет задавать, например один шаблон
для нескольких секций, "разводя" различия с помощью элемента "&lt;SwitchBand&gt;", использовать
PHP вставки, которые, в зависимости от контекста, кардинально меняют не только содержимое ячеек,
но и структуру таблицы. Такой функциональности в визуальном дизайнере добиться крайне непросто.<BR/>

	</td>
</tr>
</table>

<script>
function goTo(rej)
{
	var html = (document.location.href.replace(/#.*/, "").substr(-4) == 'html'); //zaliv
	if ( rej.indexOf('.') < 0 )
	{
// без расширения типа "cp"
		if ( html )
		{
			var arr = rej.split('#');
			rej = arr[0] + ".html";
			if ( arr[1] )
				rej += "#" + arr[1];
		}
		else
			rej = "index.php?chapt=" + rej;
	}
	else
	{
		if ( !html && rej.search(/\.(php|txt|zip)/) < 0 )
			rej = "sample/" + rej;
	}
	document.location.href = rej;
}

var pad = 0;
var oTab = document.getElementById("tabInf");
var tim;
function cPad()
{
	pad += 1;
	if ( pad > 11 )
		pad = 0;
	oTab.rows[2].cells[0].style.backgroundPosition = pad + "px 0px";
	oTab.rows[3].cells[1].style.backgroundPosition = "0px " + pad + "px";
	clearTimeout(tim);
	tim = setTimeout(cPad, 100);
}
//if ( !window.ActiveXObject )
//	setInterval(cPad, 100);
tim = setTimeout(cPad, 100);

</script>
</body>
</html>
